<nav class="bg-white shadow-md">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center space-x-8">
                <a href="{{ url_for('dashboard.index') }}" class="text-xl font-bold text-blue-600">
                    Email Alerter
                </a>
                <div class="hidden md:flex space-x-4">
                    <a href="{{ url_for('dashboard.index') }}"
                       class="px-3 py-2 rounded-md text-sm font-medium
                              {% if request.endpoint == 'dashboard.index' %}bg-blue-100 text-blue-700{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                        Dashboard
                    </a>
                    <a href="{{ url_for('dashboard.accounts') }}"
                       class="px-3 py-2 rounded-md text-sm font-medium
                              {% if request.endpoint == 'dashboard.accounts' %}bg-blue-100 text-blue-700{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                        Accounts
                    </a>
                    <a href="{{ url_for('whitelist.index') }}"
                       class="px-3 py-2 rounded-md text-sm font-medium
                              {% if request.endpoint == 'whitelist.index' %}bg-blue-100 text-blue-700{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                        Whitelist
                    </a>
                    <a href="{{ url_for('blacklist.index') }}"
                       class="px-3 py-2 rounded-md text-sm font-medium
                              {% if request.endpoint == 'blacklist.index' %}bg-red-100 text-red-700{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                        Blacklist
                    </a>
                    <a href="{{ url_for('dashboard.history') }}"
                       class="px-3 py-2 rounded-md text-sm font-medium
                              {% if request.endpoint == 'dashboard.history' %}bg-blue-100 text-blue-700{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                        History
                    </a>
                </div>
            </div>
            <div>
                <button onclick="checkNow()" id="check-now-btn"
                        class="bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition">
                    Check Now
                </button>
            </div>
        </div>
    </div>
</nav>

<script>
async function checkNow() {
    const btn = document.getElementById('check-now-btn');
    const originalText = btn.innerText;
    btn.innerText = 'Checking...';
    btn.disabled = true;

    try {
        const response = await fetch('/api/check-now', { method: 'POST' });
        const data = await response.json();

        if (data.success) {
            const summary = data.summary;
            alert(`Check complete!\n\nEmails fetched: ${summary.total_emails_fetched}\nNotifications sent: ${summary.total_notifications_sent}`);
            location.reload();
        } else {
            alert('Check failed: ' + data.error);
        }
    } catch (error) {
        alert('Error: ' + error.message);
    } finally {
        btn.innerText = originalText;
        btn.disabled = false;
    }
}
</script>
